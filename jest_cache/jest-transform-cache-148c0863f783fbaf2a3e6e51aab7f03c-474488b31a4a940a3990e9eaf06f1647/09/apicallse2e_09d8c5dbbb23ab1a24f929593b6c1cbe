357865369e71b01f9e832818fdd612b3
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// import type { FrameSystemEventRecord } from '@therootnetwork/types/lookup';
const api_1 = require("@polkadot/api");
// import { WsProvider } from '@polkadot/rpc-provider';
const api_2 = require("@therootnetwork/api");
// import { Api as ApiPromise } from '../packages/api/src/Api';
describe('e2e api calls', () => {
    let api;
    let blockHash;
    beforeAll(async () => {
        const providerUrl = 'wss://porcini.rootnet.app/archive/ws';
        const provider = new api_1.WsProvider(providerUrl);
        console.log('providerUrl', providerUrl);
        api = new api_1.ApiPromise((0, api_2.options)({ provider }));
        await api.isReady;
        blockHash = await api.rpc.chain.getBlockHash();
    });
    afterAll(async (done) => {
        if (api) {
            return await api.disconnect();
        }
        api = null;
        done();
    });
    it('Get correct block', async () => {
        const block = await api.rpc.chain.getBlock(blockHash).then((r) => r.block);
        expect(block.header.hash.toString()).toEqual(blockHash.toString());
    });
    it('Get correct validators', async () => {
        const validators = (await api.query.session.validators.at(blockHash));
        expect(validators.length).toBeGreaterThan(0);
    });
    it('Expect author is in validators', async () => {
        const block = await api.rpc.chain.getBlock(blockHash).then((r) => r.block);
        const header = block.header;
        const validators = (await api.query.session.validators.at(blockHash));
        console.log('validators:', validators);
        // const extHeader = createHeaderExtended(api.registry, header, validators);
        // const author: AccountId = extHeader.author;
        // expect(validators).toEqual(expect.arrayContaining([expect.objectContaining(author)]));
    });
    it('Expect at least one event', async () => {
        const events = (await api.query.system.events.at(blockHash));
        expect(events.length).toBeGreaterThan(0);
    });
    describe('Get session info', () => {
        it('Get correct session information (length, last length, era, current index, session per era', async () => {
            const currentSession = await api.derive.session.info();
            expect(currentSession.currentEra.toNumber()).toBeGreaterThanOrEqual(0);
            expect(currentSession.currentIndex.toNumber()).toBeGreaterThanOrEqual(0);
            expect(currentSession.eraLength.toNumber()).toBeGreaterThanOrEqual(0);
            expect(currentSession.isEpoch).toBe(true);
            expect(currentSession.sessionLength.toNumber()).toBeGreaterThanOrEqual(0);
            expect(currentSession.sessionsPerEra.toNumber()).toBeGreaterThanOrEqual(0);
            expect(currentSession.validatorCount.toNumber()).toBeGreaterThanOrEqual(0);
        });
    });
    describe('Get core asset id', () => {
        it('Get correct spending asset id', async () => {
            const spendingAssetId = (await api.query.genericAsset.spendingAssetId.at(blockHash));
            expect(spendingAssetId.gtn(0)).toBeTruthy();
        });
        it('Get correct staking asset id', async () => {
            const stakingAssetId = (await api.query.genericAsset.stakingAssetId.at(blockHash));
            expect(stakingAssetId.gtn(0)).toBeTruthy();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2thcmlzaG1hL3dvcmsvZnV0dXJldmVyc2UvdHJuLXJvb3RuZXQtYXBpL3BhY2thZ2VzL2FwaS90ZXN0L2UyZS9hcGkuY2FsbHMuZTJlLnRzIiwibWFwcGluZ3MiOiI7O0FBZUEsOEVBQThFO0FBQzlFLHVDQUF1RDtBQUN2RCx1REFBdUQ7QUFDdkQsNkNBQThDO0FBQzlDLCtEQUErRDtBQUUvRCxRQUFRLENBQUMsZUFBZSxFQUFFLEdBQUcsRUFBRTtJQUM3QixJQUFJLEdBQUcsQ0FBQztJQUNSLElBQUksU0FBZSxDQUFDO0lBQ3BCLFNBQVMsQ0FBQyxLQUFLLElBQUksRUFBRTtRQUNuQixNQUFNLFdBQVcsR0FBRyxzQ0FBc0MsQ0FBQztRQUMzRCxNQUFNLFFBQVEsR0FBRyxJQUFJLGdCQUFVLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDN0MsT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsV0FBVyxDQUFDLENBQUM7UUFDeEMsR0FBRyxHQUFHLElBQUksZ0JBQVUsQ0FBQyxJQUFBLGFBQU8sRUFBQyxFQUFFLFFBQVEsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUM1QyxNQUFNLEdBQUcsQ0FBQyxPQUFPLENBQUM7UUFDbEIsU0FBUyxHQUFHLE1BQU0sR0FBRyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsWUFBWSxFQUFFLENBQUM7SUFDakQsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsS0FBSyxFQUFDLElBQUksRUFBQyxFQUFFO1FBQ3BCLElBQUksR0FBRyxFQUFFO1lBQ1AsT0FBTyxNQUFNLEdBQUcsQ0FBQyxVQUFVLEVBQUUsQ0FBQztTQUMvQjtRQUNELEdBQUcsR0FBRyxJQUFJLENBQUM7UUFDWCxJQUFJLEVBQUUsQ0FBQztJQUNULENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLG1CQUFtQixFQUFFLEtBQUssSUFBSSxFQUFFO1FBQ2pDLE1BQU0sS0FBSyxHQUFVLE1BQU0sR0FBRyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLFNBQVMs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Q0FBQyxDQUFDO1FBQzdFLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFO1FBQ2pDLEVBQUUsQ0FBQywrQkFBK0IsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM3QyxNQUFNLGVBQWUsR0FBRyxDQUFDLE1BQU0sR0FBRyxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsZUFBZSxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBWSxDQUFDO1lBQ2hHLE1BQU0sQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDOUMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsOEJBQThCLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDNUMsTUFBTSxjQUFjLEdBQUcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLGNBQWMsQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLENBQVksQ0FBQztZQUM5RixNQUFNLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQzdDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMva2FyaXNobWEvd29yay9mdXR1cmV2ZXJzZS90cm4tcm9vdG5ldC1hcGkvcGFja2FnZXMvYXBpL3Rlc3QvZTJlL2FwaS5jYWxscy5lMmUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTktMjAyMSBDZW50cmFsaXR5IEludmVzdG1lbnRzIExpbWl0ZWRcbi8vXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vL1xuLy8gICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy9cbi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbi8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbi8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuLy8gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG5pbXBvcnQgeyBIYXNoLCBCbG9jaywgQWNjb3VudElkLCBBc3NldElkIH0gZnJvbSBcIkB0aGVyb290bmV0d29yay90eXBlcy9pbnRlcmZhY2VzXCI7XG5pbXBvcnQgeyBjcmVhdGVIZWFkZXJFeHRlbmRlZCB9IGZyb20gJ0Bwb2xrYWRvdC9hcGktZGVyaXZlL3R5cGUnO1xuLy8gaW1wb3J0IHR5cGUgeyBGcmFtZVN5c3RlbUV2ZW50UmVjb3JkIH0gZnJvbSAnQHRoZXJvb3RuZXR3b3JrL3R5cGVzL2xvb2t1cCc7XG5pbXBvcnQgeyBBcGlQcm9taXNlLCBXc1Byb3ZpZGVyIH0gZnJvbSAnQHBvbGthZG90L2FwaSc7XG4vLyBpbXBvcnQgeyBXc1Byb3ZpZGVyIH0gZnJvbSAnQHBvbGthZG90L3JwYy1wcm92aWRlcic7XG5pbXBvcnQgeyBvcHRpb25zIH0gZnJvbSAnQHRoZXJvb3RuZXR3b3JrL2FwaSc7XG4vLyBpbXBvcnQgeyBBcGkgYXMgQXBpUHJvbWlzZSB9IGZyb20gJy4uL3BhY2thZ2VzL2FwaS9zcmMvQXBpJztcblxuZGVzY3JpYmUoJ2UyZSBhcGkgY2FsbHMnLCAoKSA9PiB7XG4gIGxldCBhcGk7XG4gIGxldCBibG9ja0hhc2g6IEhhc2g7XG4gIGJlZm9yZUFsbChhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgcHJvdmlkZXJVcmwgPSAnd3NzOi8vcG9yY2luaS5yb290bmV0LmFwcC9hcmNoaXZlL3dzJztcbiAgICBjb25zdCBwcm92aWRlciA9IG5ldyBXc1Byb3ZpZGVyKHByb3ZpZGVyVXJsKTtcbiAgICBjb25zb2xlLmxvZygncHJvdmlkZXJVcmwnLCBwcm92aWRlclVybCk7XG4gICAgYXBpID0gbmV3IEFwaVByb21pc2Uob3B0aW9ucyh7IHByb3ZpZGVyIH0pKTtcbiAgICBhd2FpdCBhcGkuaXNSZWFkeTtcbiAgICBibG9ja0hhc2ggPSBhd2FpdCBhcGkucnBjLmNoYWluLmdldEJsb2NrSGFzaCgpO1xuICB9KTtcblxuICBhZnRlckFsbChhc3luYyBkb25lID0+IHtcbiAgICBpZiAoYXBpKSB7XG4gICAgICByZXR1cm4gYXdhaXQgYXBpLmRpc2Nvbm5lY3QoKTtcbiAgICB9XG4gICAgYXBpID0gbnVsbDtcbiAgICBkb25lKCk7XG4gIH0pO1xuXG4gIGl0KCdHZXQgY29ycmVjdCBibG9jaycsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBibG9jazogQmxvY2sgPSBhd2FpdCBhcGkucnBjLmNoYWluLmdldEJsb2NrKGJsb2NrSGFzaCkudGhlbigocjogYW55KSA9PiByLmJsb2NrKTtcbiAgICBleHBlY3QoYmxvY2suaGVhZGVyLmhhc2gudG9TdHJpbmcoKSkudG9FcXVhbChibG9ja0hhc2gudG9TdHJpbmcoKSk7XG4gIH0pO1xuXG4gIGl0KCdHZXQgY29ycmVjdCB2YWxpZGF0b3JzJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkYXRvcnM6IEFjY291bnRJZFtdID0gKGF3YWl0IGFwaS5xdWVyeS5zZXNzaW9uLnZhbGlkYXRvcnMuYXQoYmxvY2tIYXNoKSkgYXMgYW55O1xuICAgIGV4cGVjdCh2YWxpZGF0b3JzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICB9KTtcblxuICBpdCgnRXhwZWN0IGF1dGhvciBpcyBpbiB2YWxpZGF0b3JzJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGJsb2NrOiBCbG9jayA9IGF3YWl0IGFwaS5ycGMuY2hhaW4uZ2V0QmxvY2soYmxvY2tIYXNoKS50aGVuKChyOiBhbnkpID0+IHIuYmxvY2spO1xuICAgIGNvbnN0IGhlYWRlciA9IGJsb2NrLmhlYWRlcjtcbiAgICBjb25zdCB2YWxpZGF0b3JzOiBBY2NvdW50SWRbXSA9IChhd2FpdCBhcGkucXVlcnkuc2Vzc2lvbi52YWxpZGF0b3JzLmF0KGJsb2NrSGFzaCkpIGFzIGFueTtcbiAgICBjb25zb2xlLmxvZygndmFsaWRhdG9yczonLHZhbGlkYXRvcnMpO1xuICAgIC8vIGNvbnN0IGV4dEhlYWRlciA9IGNyZWF0ZUhlYWRlckV4dGVuZGVkKGFwaS5yZWdpc3RyeSwgaGVhZGVyLCB2YWxpZGF0b3JzKTtcbiAgICAvLyBjb25zdCBhdXRob3I6IEFjY291bnRJZCA9IGV4dEhlYWRlci5hdXRob3I7XG4gICAgLy8gZXhwZWN0KHZhbGlkYXRvcnMpLnRvRXF1YWwoZXhwZWN0LmFycmF5Q29udGFpbmluZyhbZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoYXV0aG9yKV0pKTtcbiAgfSk7XG5cbiAgaXQoJ0V4cGVjdCBhdCBsZWFzdCBvbmUgZXZlbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgZXZlbnRzID0gKGF3YWl0IGFwaS5xdWVyeS5zeXN0ZW0uZXZlbnRzLmF0KGJsb2NrSGFzaCkpIGFzIGFueTtcbiAgICBleHBlY3QoZXZlbnRzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICB9KTtcblxuICBkZXNjcmliZSgnR2V0IHNlc3Npb24gaW5mbycsICgpID0+IHtcbiAgICBpdCgnR2V0IGNvcnJlY3Qgc2Vzc2lvbiBpbmZvcm1hdGlvbiAobGVuZ3RoLCBsYXN0IGxlbmd0aCwgZXJhLCBjdXJyZW50IGluZGV4LCBzZXNzaW9uIHBlciBlcmEnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjdXJyZW50U2Vzc2lvbiA9IGF3YWl0IGFwaS5kZXJpdmUuc2Vzc2lvbi5pbmZvKCk7XG4gICAgICBleHBlY3QoY3VycmVudFNlc3Npb24uY3VycmVudEVyYS50b051bWJlcigpKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xuICAgICAgZXhwZWN0KGN1cnJlbnRTZXNzaW9uLmN1cnJlbnRJbmRleC50b051bWJlcigpKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xuICAgICAgZXhwZWN0KGN1cnJlbnRTZXNzaW9uLmVyYUxlbmd0aC50b051bWJlcigpKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xuICAgICAgZXhwZWN0KGN1cnJlbnRTZXNzaW9uLmlzRXBvY2gpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoY3VycmVudFNlc3Npb24uc2Vzc2lvbkxlbmd0aC50b051bWJlcigpKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xuICAgICAgZXhwZWN0KGN1cnJlbnRTZXNzaW9uLnNlc3Npb25zUGVyRXJhLnRvTnVtYmVyKCkpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMCk7XG4gICAgICBleHBlY3QoY3VycmVudFNlc3Npb24udmFsaWRhdG9yQ291bnQudG9OdW1iZXIoKSkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0dldCBjb3JlIGFzc2V0IGlkJywgKCkgPT4ge1xuICAgIGl0KCdHZXQgY29ycmVjdCBzcGVuZGluZyBhc3NldCBpZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNwZW5kaW5nQXNzZXRJZCA9IChhd2FpdCBhcGkucXVlcnkuZ2VuZXJpY0Fzc2V0LnNwZW5kaW5nQXNzZXRJZC5hdChibG9ja0hhc2gpKSBhcyBBc3NldElkO1xuICAgICAgZXhwZWN0KHNwZW5kaW5nQXNzZXRJZC5ndG4oMCkpLnRvQmVUcnV0aHkoKTtcbiAgICB9KTtcblxuICAgIGl0KCdHZXQgY29ycmVjdCBzdGFraW5nIGFzc2V0IGlkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3Rha2luZ0Fzc2V0SWQgPSAoYXdhaXQgYXBpLnF1ZXJ5LmdlbmVyaWNBc3NldC5zdGFraW5nQXNzZXRJZC5hdChibG9ja0hhc2gpKSBhcyBBc3NldElkO1xuICAgICAgZXhwZWN0KHN0YWtpbmdBc3NldElkLmd0bigwKSkudG9CZVRydXRoeSgpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9